{% extends "base.html" %}

{% block content %}
<section class="search-section">
  <form class="search-form" id="search-form">
    <div class="search-mode-toggle">
    <span class="panel-subtitle">Query</span>

    <button type="button" id="upload-btn" class="secondary-btn">
      <span class="icon">ğŸ“„</span>
      Upload text / paper
    </button>

    <!-- hidden file input -->
    <label class="file-input-label" style="display:none;">
      <input type="file" id="upload-input" accept=".txt,.md,.pdf"/>
    </label>
  </div>

  <div class="search-row">
    <input id="query-input" name="query" class="search-input" type="text" placeholder="Describe your paper, topic, or paste textâ€¦"/>
    <select id="search-type" class="search-type-select">
      <option value="hybrid">Hybrid</option>
      <option value="papers">Papers only</option>
      <option value="venue">Venues only</option>
      <option value="concepts">Concepts only</option>
    </select>
    <button id="search-btn" class="primary-btn" type="button">
      <span class="icon">ğŸ”</span>
      Search
    </button>
  </div>

    <div class="weights-row">
      <label class="weight-label">
        Paper weight
        <input type="number" step="0.1" min="0" max="1" name="paper_weight" value="0.8">
      </label>
      <label class="weight-label">
        Concept weight
        <input type="number" step="0.1" min="0" max="1" name="concept_weight" value="0.2">
      </label>
    </div>
  </form>

  <form
    id="upload-form"
    class="upload-form"
    method="post"
    enctype="multipart/form-data"
    style="display:none"
  >
    <label class="file-input-label">
      <span class="icon">ğŸ“„</span>
      <span>Select a text file with your paper (title + abstract)</span>
      <input type="file" name="paper_file" accept=".txt,.md,.tex,.csv,.log,.json,.py,.ipynb">
    </label>
    <button type="submit" class="secondary-btn">Search from file</button>
  </form>
</section>

<section class="results-grid">
  <!-- Left large pane: Papers -->
  <section class="panel panel-papers">
    <div class="panel-header">
      <h2>Papers</h2>
      <span class="panel-subtitle" id="papers-subtitle"></span>
    </div>

    <div class="panel-controls">
      <span class="panel-controls-label">Rows per page:</span>
      <div class="panel-page-size" data-panel="papers">
        <button type="button" class="ghost-btn page-size-btn active" data-size="5">5</button>
        <button type="button" class="ghost-btn page-size-btn" data-size="10">10</button>
        <button type="button" class="ghost-btn page-size-btn" data-size="20">20</button>
      </div>
    </div>

    <div class="panel-body" id="papers-panel-body">
      <div class="panel-loader" id="papers-loader" hidden>
        <div class="spinner"></div>
        <span>Loading papersâ€¦</span>
      </div>
      <ul class="paper-list" id="papers-list"></ul>
      <p class="muted" id="papers-empty">Type a query or upload a research paper to see results.</p>
    </div>

    <div class="panel-footer pagination-footer">
      <div class="pagination-controls" data-panel="papers">
        <button type="button" class="ghost-btn pager-prev" disabled>â† Previous</button>
        <span class="current-page-pill pager-label">Page 1</span>
        <button type="button" class="ghost-btn pager-next" disabled>Next â†’</button>
      </div>
    </div>
  </section>

  <!-- Top right: Authors -->
  <section class="panel panel-authors">
    <div class="panel-header">
      <h2>Authors</h2>
    </div>

    <div class="panel-controls">
      <span class="panel-controls-label">Rows per page:</span>
      <div class="panel-page-size" data-panel="authors">
        <button type="button" class="ghost-btn page-size-btn active" data-size="5">5</button>
        <button type="button" class="ghost-btn page-size-btn" data-size="10">10</button>
        <button type="button" class="ghost-btn page-size-btn" data-size="20">20</button>
      </div>
    </div>

    <div class="panel-body" id="authors-panel-body">
      <div class="panel-loader" id="authors-loader" hidden>
        <div class="spinner"></div>
        <span>Loading authorsâ€¦</span>
      </div>
      <ul class="author-list" id="authors-list"></ul>
      <p class="muted" id="authors-empty">Run a search to see prominent authors.</p>
    </div>

    <div class="panel-footer pagination-footer">
      <div class="pagination-controls" data-panel="authors">
        <button type="button" class="ghost-btn pager-prev" disabled>â† Previous</button>
        <span class="current-page-pill pager-label">Page 1</span>
        <button type="button" class="ghost-btn pager-next" disabled>Next â†’</button>
      </div>
    </div>
  </section>

  <!-- Bottom right: Venues -->
  <section class="panel panel-venues">
    <div class="panel-header">
      <h2>Venues</h2>
    </div>

    <div class="panel-controls">
      <span class="panel-controls-label">Rows per page:</span>
      <div class="panel-page-size" data-panel="venues">
        <button type="button" class="ghost-btn page-size-btn active" data-size="5">5</button>
        <button type="button" class="ghost-btn page-size-btn" data-size="10">10</button>
        <button type="button" class="ghost-btn page-size-btn" data-size="20">20</button>
      </div>
    </div>

    <div class="panel-body" id="venues-panel-body">
      <div class="panel-loader" id="venues-loader" hidden>
        <div class="spinner"></div>
        <span>Loading venuesâ€¦</span>
      </div>
      <ul class="venue-list" id="venues-list"></ul>
      <p class="muted" id="venues-empty">Run a search to see recommended venues.</p>
    </div>

    <div class="panel-footer pagination-footer">
      <div class="pagination-controls" data-panel="venues">
        <button type="button" class="ghost-btn pager-prev" disabled>â† Previous</button>
        <span class="current-page-pill pager-label">Page 1</span>
        <button type="button" class="ghost-btn pager-next" disabled>Next â†’</button>
      </div>
    </div>
  </section>
</section>
{% endblock %}